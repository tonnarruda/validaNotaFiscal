{"ast":null,"code":"var _jsxFileName = \"/Users/georgemjunior/workspace/Georgem/nf-decoder-ai/frontend/src/components/NfValidator.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport * as XLSX from 'xlsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NfValidator = () => {\n  _s();\n  const [comparisonData, setComparisonData] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [isAddingManually, setIsAddingManually] = useState(false);\n  const [newNf, setNewNf] = useState({\n    cnpj: '',\n    numero: '',\n    valor: ''\n  });\n  const formatCurrency = value => {\n    if (typeof value !== 'number') return 'R$ 0,00';\n    return value.toLocaleString('pt-BR', {\n      style: 'currency',\n      currency: 'BRL'\n    });\n  };\n  const normalizeString = str => {\n    if (!str) return '';\n    return str.toString().replace(/[.\\-/]/g, '');\n  };\n  const handleClearAll = () => {\n    setComparisonData([]);\n    setError('');\n    setIsAddingManually(false);\n  };\n  const handleNewNfChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setNewNf(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const handleSaveNewNf = () => {\n    if (!newNf.cnpj || !newNf.numero || !newNf.valor) {\n      setError(\"Preencha todos os campos para salvar a nota.\");\n      return;\n    }\n    const newRow = {\n      nfCnpj: newNf.cnpj,\n      nfNumero: newNf.numero,\n      nfValor: parseFloat(newNf.valor.replace(',', '.')) || 0.0,\n      plCnpj: 'N/A',\n      plNumero: 'N/A',\n      plValor: 0.0,\n      status: 'Divergente'\n    };\n    setComparisonData(prevData => [newRow, ...prevData]);\n    setNewNf({\n      cnpj: '',\n      numero: '',\n      valor: ''\n    });\n    setIsAddingManually(false);\n    setError('');\n  };\n  const handleCancelNewNf = () => {\n    setNewNf({\n      cnpj: '',\n      numero: '',\n      valor: ''\n    });\n    setIsAddingManually(false);\n    setError('');\n  };\n  const onPdfDrop = useCallback(async acceptedFiles => {\n    if (acceptedFiles.length === 0) return;\n    setLoading(true);\n    setError('');\n    const formData = new FormData();\n    acceptedFiles.forEach(file => {\n      formData.append('files', file);\n    });\n    try {\n      const response = await fetch('/upload', {\n        method: 'POST',\n        body: formData\n      });\n      if (!response.ok) {\n        const errData = await response.json();\n        throw new Error(errData.error || 'Erro no servidor ao processar PDFs.');\n      }\n      const nfData = await response.json();\n      const newComparisonData = nfData.map(nf => ({\n        nfCnpj: nf['CNPJ (NF)'],\n        nfPrestador: nf['Prestador de Serviços'],\n        nfNumero: nf['Número da Nota (NF)'],\n        nfValor: nf['Valor (NF)'],\n        plCnpj: 'N/A',\n        plNumero: 'N/A',\n        plValor: 0.0,\n        status: 'Divergente'\n      }));\n      setComparisonData(prevData => [...prevData, ...newComparisonData]);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  const onExcelDrop = useCallback(acceptedFiles => {\n    if (acceptedFiles.length === 0 || comparisonData.length === 0) {\n      if (comparisonData.length === 0) {\n        setError(\"Por favor, importe os PDFs primeiro.\");\n      }\n      return;\n    }\n    const file = acceptedFiles[0];\n    const reader = new FileReader();\n    reader.onload = event => {\n      try {\n        const bstr = event.target.result;\n        const wb = XLSX.read(bstr, {\n          type: 'binary'\n        });\n        const wsname = wb.SheetNames[0];\n        const ws = wb.Sheets[wsname];\n        const data = XLSX.utils.sheet_to_json(ws, {\n          header: 1\n        });\n        const header = data[0];\n        const cnpjIndex = header.findIndex(h => h.toLowerCase().includes('cnpj'));\n        const nfNumeroIndex = header.findIndex(h => h.toLowerCase().includes('nota'));\n        const valorIndex = header.findIndex(h => h.toLowerCase().includes('valor'));\n        if (cnpjIndex === -1 || nfNumeroIndex === -1 || valorIndex === -1) {\n          setError(\"A planilha Excel deve conter as colunas 'CNPJ', 'Nota' e 'Valor'.\");\n          return;\n        }\n        const excelDataMap = new Map();\n        data.slice(1).forEach(row => {\n          const key = `${normalizeString(row[cnpjIndex])}-${normalizeString(row[nfNumeroIndex])}`;\n          excelDataMap.set(key, {\n            cnpj: row[cnpjIndex],\n            numero: row[nfNumeroIndex],\n            valor: parseFloat(row[valorIndex]) || 0.0\n          });\n        });\n        const updatedComparisonData = comparisonData.map(item => {\n          const key = `${normalizeString(item.nfCnpj)}-${normalizeString(item.nfNumero)}`;\n          const match = excelDataMap.get(key);\n          if (match) {\n            const nfValor = parseFloat(item.nfValor);\n            const plValor = match.valor;\n            const status = Math.abs(nfValor - plValor) < 0.01 ? 'Convergente' : 'Divergente';\n            return {\n              ...item,\n              plCnpj: match.cnpj,\n              plNumero: match.numero,\n              plValor: plValor,\n              status: status\n            };\n          }\n          return item;\n        });\n        setComparisonData(updatedComparisonData);\n      } catch (err) {\n        setError(\"Erro ao processar o arquivo Excel.\");\n      }\n    };\n    reader.readAsBinaryString(file);\n  }, [comparisonData]);\n  const {\n    getRootProps: getPdfRootProps,\n    getInputProps: getPdfInputProps\n  } = useDropzone({\n    onDrop: onPdfDrop,\n    accept: {\n      'application/pdf': ['.pdf']\n    },\n    multiple: true\n  });\n  const {\n    getRootProps: getExcelRootProps,\n    getInputProps: getExcelInputProps\n  } = useDropzone({\n    onDrop: onExcelDrop,\n    accept: {\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx'],\n      'application/vnd.ms-excel': ['.xls']\n    },\n    multiple: false\n  });\n  const getStatusClass = status => {\n    switch (status) {\n      case 'Convergente':\n        return 'bg-green-100 text-green-800';\n      case 'Divergente':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n  const ManualAddRow = () => /*#__PURE__*/_jsxDEV(\"tr\", {\n    className: \"bg-blue-50 border-b-2 border-blue-200\",\n    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n      className: \"p-2\",\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"cnpj\",\n        value: newNf.cnpj,\n        onChange: handleNewNfChange,\n        placeholder: \"CNPJ (NF)\",\n        className: \"p-2 border rounded w-full\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n      className: \"p-2\",\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"numero\",\n        value: newNf.numero,\n        onChange: handleNewNfChange,\n        placeholder: \"N\\xFAmero da Nota\",\n        className: \"p-2 border rounded w-full\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n      className: \"p-2\",\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"valor\",\n        type: \"number\",\n        value: newNf.valor,\n        onChange: handleNewNfChange,\n        placeholder: \"Valor (NF)\",\n        className: \"p-2 border rounded w-full\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n      colSpan: \"3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n      className: \"p-2 text-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSaveNewNf,\n          className: \"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-3 rounded text-sm\",\n          children: \"Salvar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCancelNewNf,\n          className: \"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-3 rounded text-sm\",\n          children: \"Cancelar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 186,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white p-8 rounded-lg shadow-lg\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between items-center mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold\",\n        children: \"Validador de Notas Fiscais\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setIsAddingManually(true),\n          disabled: isAddingManually,\n          className: \"bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition-colors disabled:bg-gray-300\",\n          children: \"Adicionar Nota\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleClearAll,\n          className: \"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition-colors\",\n          children: \"Limpar Tudo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-white text-xl\",\n        children: \"Processando PDFs...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\",\n      role: \"alert\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        ...getPdfRootProps(),\n        className: \"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-blue-500 bg-gray-50 transition-colors\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          ...getPdfInputProps()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-blue-600 font-semibold\",\n          children: \"IMPORTAR NOTAS FISCAIS (PDF)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 mt-1\",\n          children: \"Arraste e solte os PDFs aqui, ou clique para selecionar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ...getExcelRootProps(),\n        className: \"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-purple-500 bg-gray-50 transition-colors\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          ...getExcelInputProps()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-purple-600 font-semibold\",\n          children: \"IMPORTAR PLANILHA EXCEL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 mt-1\",\n          children: \"Arraste e solte o Excel aqui, ou clique para selecionar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"overflow-x-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"min-w-full bg-white\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          className: \"bg-gray-200\",\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-left text-sm font-semibold text-gray-600\",\n              children: \"Prestador de Servi\\xE7os\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-left text-sm font-semibold text-gray-600\",\n              children: \"CNPJ (NF)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-left text-sm font-semibold text-gray-600\",\n              children: \"N\\xFAmero da Nota (NF)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-left text-sm font-semibold text-gray-600\",\n              children: \"Valor (NF)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-left text-sm font-semibold text-gray-600\",\n              children: \"CNPJ (Planilha)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-left text-sm font-semibold text-gray-600\",\n              children: \"N\\xFAmero da Nota (Planilha)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-left text-sm font-semibold text-gray-600\",\n              children: \"Valor (Planilha)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"py-3 px-4 text-center text-sm font-semibold text-gray-600\",\n              children: \"Status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: [isAddingManually && /*#__PURE__*/_jsxDEV(ManualAddRow, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 34\n          }, this), comparisonData.length > 0 ? comparisonData.map((item, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            className: \"border-b hover:bg-gray-50\",\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4\",\n              children: item.nfPrestador\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4\",\n              children: item.nfCnpj\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4\",\n              children: item.nfNumero\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4\",\n              children: formatCurrency(item.nfValor)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4\",\n              children: item.plCnpj\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4\",\n              children: item.plNumero\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4\",\n              children: formatCurrency(item.plValor)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"py-3 px-4 text-center\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `px-3 py-1 text-xs font-medium rounded-full ${getStatusClass(item.status)}`,\n                children: item.status\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 17\n          }, this)) : !isAddingManually && /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: \"7\",\n              className: \"text-center py-10 text-gray-500\",\n              children: \"Aguardando importa\\xE7\\xE3o dos arquivos...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 7\n    }, this), comparisonData.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-end items-center mt-4 text-sm text-gray-600\",\n      children: `Mostrando 1-${comparisonData.length} de ${comparisonData.length}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 201,\n    columnNumber: 5\n  }, this);\n};\n_s(NfValidator, \"rIsykB0FoYSS2xBU0x12RQR1144=\", false, function () {\n  return [useDropzone, useDropzone];\n});\n_c = NfValidator;\nexport default NfValidator;\nvar _c;\n$RefreshReg$(_c, \"NfValidator\");","map":{"version":3,"names":["React","useState","useCallback","useDropzone","XLSX","jsxDEV","_jsxDEV","NfValidator","_s","comparisonData","setComparisonData","loading","setLoading","error","setError","isAddingManually","setIsAddingManually","newNf","setNewNf","cnpj","numero","valor","formatCurrency","value","toLocaleString","style","currency","normalizeString","str","toString","replace","handleClearAll","handleNewNfChange","e","name","target","prev","handleSaveNewNf","newRow","nfCnpj","nfNumero","nfValor","parseFloat","plCnpj","plNumero","plValor","status","prevData","handleCancelNewNf","onPdfDrop","acceptedFiles","length","formData","FormData","forEach","file","append","response","fetch","method","body","ok","errData","json","Error","nfData","newComparisonData","map","nf","nfPrestador","err","message","onExcelDrop","reader","FileReader","onload","event","bstr","result","wb","read","type","wsname","SheetNames","ws","Sheets","data","utils","sheet_to_json","header","cnpjIndex","findIndex","h","toLowerCase","includes","nfNumeroIndex","valorIndex","excelDataMap","Map","slice","row","key","set","updatedComparisonData","item","match","get","Math","abs","readAsBinaryString","getRootProps","getPdfRootProps","getInputProps","getPdfInputProps","onDrop","accept","multiple","getExcelRootProps","getExcelInputProps","getStatusClass","ManualAddRow","className","children","onChange","placeholder","fileName","_jsxFileName","lineNumber","columnNumber","colSpan","onClick","disabled","role","index","_c","$RefreshReg$"],"sources":["/Users/georgemjunior/workspace/Georgem/nf-decoder-ai/frontend/src/components/NfValidator.jsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport * as XLSX from 'xlsx';\n\nconst NfValidator = () => {\n  const [comparisonData, setComparisonData] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [isAddingManually, setIsAddingManually] = useState(false);\n  const [newNf, setNewNf] = useState({ cnpj: '', numero: '', valor: '' });\n\n  const formatCurrency = (value) => {\n    if (typeof value !== 'number') return 'R$ 0,00';\n    return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });\n  };\n  \n  const normalizeString = (str) => {\n    if (!str) return '';\n    return str.toString().replace(/[.\\-/]/g, '');\n  }\n\n  const handleClearAll = () => {\n    setComparisonData([]);\n    setError('');\n    setIsAddingManually(false);\n  };\n\n  const handleNewNfChange = (e) => {\n    const { name, value } = e.target;\n    setNewNf(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleSaveNewNf = () => {\n    if (!newNf.cnpj || !newNf.numero || !newNf.valor) {\n      setError(\"Preencha todos os campos para salvar a nota.\");\n      return;\n    }\n    const newRow = {\n      nfCnpj: newNf.cnpj,\n      nfNumero: newNf.numero,\n      nfValor: parseFloat(newNf.valor.replace(',', '.')) || 0.0,\n      plCnpj: 'N/A',\n      plNumero: 'N/A',\n      plValor: 0.0,\n      status: 'Divergente',\n    };\n    setComparisonData(prevData => [newRow, ...prevData]);\n    setNewNf({ cnpj: '', numero: '', valor: '' });\n    setIsAddingManually(false);\n    setError('');\n  };\n\n  const handleCancelNewNf = () => {\n    setNewNf({ cnpj: '', numero: '', valor: '' });\n    setIsAddingManually(false);\n    setError('');\n  };\n\n  const onPdfDrop = useCallback(async (acceptedFiles) => {\n    if (acceptedFiles.length === 0) return;\n\n    setLoading(true);\n    setError('');\n\n    const formData = new FormData();\n    acceptedFiles.forEach(file => {\n      formData.append('files', file);\n    });\n\n    try {\n      const response = await fetch('/upload', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errData = await response.json();\n        throw new Error(errData.error || 'Erro no servidor ao processar PDFs.');\n      }\n\n      const nfData = await response.json();\n\n      const newComparisonData = nfData.map(nf => ({\n        nfCnpj: nf['CNPJ (NF)'],\n        nfPrestador: nf['Prestador de Serviços'],\n        nfNumero: nf['Número da Nota (NF)'],\n        nfValor: nf['Valor (NF)'],\n        plCnpj: 'N/A',\n        plNumero: 'N/A',\n        plValor: 0.0,\n        status: 'Divergente',\n      }));\n\n      setComparisonData(prevData => [...prevData, ...newComparisonData]);\n\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const onExcelDrop = useCallback((acceptedFiles) => {\n    if (acceptedFiles.length === 0 || comparisonData.length === 0) {\n        if (comparisonData.length === 0) {\n            setError(\"Por favor, importe os PDFs primeiro.\");\n        }\n        return;\n    }\n\n    const file = acceptedFiles[0];\n    const reader = new FileReader();\n\n    reader.onload = (event) => {\n        try {\n            const bstr = event.target.result;\n            const wb = XLSX.read(bstr, { type: 'binary' });\n            const wsname = wb.SheetNames[0];\n            const ws = wb.Sheets[wsname];\n            const data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n            \n            const header = data[0];\n            const cnpjIndex = header.findIndex(h => h.toLowerCase().includes('cnpj'));\n            const nfNumeroIndex = header.findIndex(h => h.toLowerCase().includes('nota'));\n            const valorIndex = header.findIndex(h => h.toLowerCase().includes('valor'));\n\n            if(cnpjIndex === -1 || nfNumeroIndex === -1 || valorIndex === -1) {\n                setError(\"A planilha Excel deve conter as colunas 'CNPJ', 'Nota' e 'Valor'.\");\n                return;\n            }\n\n            const excelDataMap = new Map();\n            data.slice(1).forEach(row => {\n                const key = `${normalizeString(row[cnpjIndex])}-${normalizeString(row[nfNumeroIndex])}`;\n                excelDataMap.set(key, {\n                    cnpj: row[cnpjIndex],\n                    numero: row[nfNumeroIndex],\n                    valor: parseFloat(row[valorIndex]) || 0.0,\n                });\n            });\n\n            const updatedComparisonData = comparisonData.map(item => {\n                const key = `${normalizeString(item.nfCnpj)}-${normalizeString(item.nfNumero)}`;\n                const match = excelDataMap.get(key);\n\n                if (match) {\n                    const nfValor = parseFloat(item.nfValor);\n                    const plValor = match.valor;\n                    const status = Math.abs(nfValor - plValor) < 0.01 ? 'Convergente' : 'Divergente';\n\n                    return { ...item, plCnpj: match.cnpj, plNumero: match.numero, plValor: plValor, status: status };\n                }\n                return item;\n            });\n\n            setComparisonData(updatedComparisonData);\n\n        } catch (err) {\n            setError(\"Erro ao processar o arquivo Excel.\");\n        }\n    };\n    reader.readAsBinaryString(file);\n  }, [comparisonData]);\n\n  const { getRootProps: getPdfRootProps, getInputProps: getPdfInputProps } = useDropzone({\n    onDrop: onPdfDrop,\n    accept: { 'application/pdf': ['.pdf'] },\n    multiple: true\n  });\n  \n  const { getRootProps: getExcelRootProps, getInputProps: getExcelInputProps } = useDropzone({\n    onDrop: onExcelDrop,\n    accept: { 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx'], 'application/vnd.ms-excel': ['.xls'] },\n    multiple: false\n  });\n\n  const getStatusClass = (status) => {\n    switch (status) {\n      case 'Convergente': return 'bg-green-100 text-green-800';\n      case 'Divergente': return 'bg-red-100 text-red-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const ManualAddRow = () => (\n    <tr className=\"bg-blue-50 border-b-2 border-blue-200\">\n        <td className=\"p-2\"><input name=\"cnpj\" value={newNf.cnpj} onChange={handleNewNfChange} placeholder=\"CNPJ (NF)\" className=\"p-2 border rounded w-full\"/></td>\n        <td className=\"p-2\"><input name=\"numero\" value={newNf.numero} onChange={handleNewNfChange} placeholder=\"Número da Nota\" className=\"p-2 border rounded w-full\"/></td>\n        <td className=\"p-2\"><input name=\"valor\" type=\"number\" value={newNf.valor} onChange={handleNewNfChange} placeholder=\"Valor (NF)\" className=\"p-2 border rounded w-full\"/></td>\n        <td colSpan=\"3\"></td>\n        <td className=\"p-2 text-center\">\n            <div className=\"flex justify-center items-center gap-2\">\n                <button onClick={handleSaveNewNf} className=\"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-3 rounded text-sm\">Salvar</button>\n                <button onClick={handleCancelNewNf} className=\"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-3 rounded text-sm\">Cancelar</button>\n            </div>\n        </td>\n    </tr>\n  );\n\n  return (\n    <div className=\"bg-white p-8 rounded-lg shadow-lg\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-3xl font-bold\">Validador de Notas Fiscais</h1>\n        <div className=\"flex gap-4\">\n          <button \n            onClick={() => setIsAddingManually(true)}\n            disabled={isAddingManually}\n            className=\"bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition-colors disabled:bg-gray-300\"\n          >\n            Adicionar Nota\n          </button>\n          <button \n            onClick={handleClearAll}\n            className=\"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition-colors\"\n          >\n            Limpar Tudo\n          </button>\n        </div>\n      </div>\n      \n      {loading && (\n        <div className=\"fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"text-white text-xl\">Processando PDFs...</div>\n        </div>\n      )}\n\n      {error && <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\" role=\"alert\">{error}</div>}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n        <div {...getPdfRootProps()} className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-blue-500 bg-gray-50 transition-colors\">\n          <input {...getPdfInputProps()} />\n          <p className=\"text-blue-600 font-semibold\">IMPORTAR NOTAS FISCAIS (PDF)</p>\n          <p className=\"text-sm text-gray-500 mt-1\">Arraste e solte os PDFs aqui, ou clique para selecionar</p>\n        </div>\n        <div {...getExcelRootProps()} className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-purple-500 bg-gray-50 transition-colors\">\n          <input {...getExcelInputProps()} />\n          <p className=\"text-purple-600 font-semibold\">IMPORTAR PLANILHA EXCEL</p>\n          <p className=\"text-sm text-gray-500 mt-1\">Arraste e solte o Excel aqui, ou clique para selecionar</p>\n        </div>\n      </div>\n\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full bg-white\">\n          <thead className=\"bg-gray-200\">\n            <tr>\n              <th className=\"py-3 px-4 text-left text-sm font-semibold text-gray-600\">Prestador de Serviços</th>\n              <th className=\"py-3 px-4 text-left text-sm font-semibold text-gray-600\">CNPJ (NF)</th>\n              <th className=\"py-3 px-4 text-left text-sm font-semibold text-gray-600\">Número da Nota (NF)</th>\n              <th className=\"py-3 px-4 text-left text-sm font-semibold text-gray-600\">Valor (NF)</th>\n              <th className=\"py-3 px-4 text-left text-sm font-semibold text-gray-600\">CNPJ (Planilha)</th>\n              <th className=\"py-3 px-4 text-left text-sm font-semibold text-gray-600\">Número da Nota (Planilha)</th>\n              <th className=\"py-3 px-4 text-left text-sm font-semibold text-gray-600\">Valor (Planilha)</th>\n              <th className=\"py-3 px-4 text-center text-sm font-semibold text-gray-600\">Status</th>\n            </tr>\n          </thead>\n          <tbody>\n            {isAddingManually && <ManualAddRow />}\n            {comparisonData.length > 0 ? (\n              comparisonData.map((item, index) => (\n                <tr key={index} className=\"border-b hover:bg-gray-50\">\n                  <td className=\"py-3 px-4\">{item.nfPrestador}</td>\n                  <td className=\"py-3 px-4\">{item.nfCnpj}</td>\n                  <td className=\"py-3 px-4\">{item.nfNumero}</td>\n                  <td className=\"py-3 px-4\">{formatCurrency(item.nfValor)}</td>\n                  <td className=\"py-3 px-4\">{item.plCnpj}</td>\n                  <td className=\"py-3 px-4\">{item.plNumero}</td>\n                  <td className=\"py-3 px-4\">{formatCurrency(item.plValor)}</td>\n                  <td className=\"py-3 px-4 text-center\">\n                    <span className={`px-3 py-1 text-xs font-medium rounded-full ${getStatusClass(item.status)}`}>\n                      {item.status}\n                    </span>\n                  </td>\n                </tr>\n              ))\n            ) : (\n              !isAddingManually && (\n                <tr>\n                  <td colSpan=\"7\" className=\"text-center py-10 text-gray-500\">\n                    Aguardando importação dos arquivos...\n                  </td>\n                </tr>\n              )\n            )}\n          </tbody>\n        </table>\n      </div>\n      {comparisonData.length > 0 && \n        <div className=\"flex justify-end items-center mt-4 text-sm text-gray-600\">\n            {`Mostrando 1-${comparisonData.length} de ${comparisonData.length}`}\n        </div>\n      }\n    </div>\n  );\n};\n\nexport default NfValidator; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}